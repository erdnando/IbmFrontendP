<div class="body viewmodule ">
    <div>
        <h1 style="color: #61677A; font-size: 2em;"><strong>Carga de Archivos</strong></h1>
        <div class="div-em">
            <span>Realíza la carga de archivos. Haz clic en la opción de tu interes para obtener más detalles</span>
            
        </div>
        <hr class="divider">
    </div>
    <br/>


<mat-tab-group>
    <mat-tab>
        <ng-template mat-tab-label>
            <mat-icon class="example-tab-icon">upload_file</mat-icon>
                Subir Archivos ARP/TSE/STE
        </ng-template>
        <br>

    <div class="body-excel" style="width: 95%;">
        <div class="overlay" *ngIf="activarBarra" style="padding:40%;position: fixed;padding-top: 20%;">
            <mat-spinner [diameter]="50"></mat-spinner>

        </div>
        <div style="width: 100%;">
        <mat-progress-bar mode="determinate" [value]="porcentajeCarga" *ngIf="activarBarra"></mat-progress-bar>
        <p *ngIf="activarBarra" class="texto-barra-carga">{{ porcentajeCarga }}% completado ({{ porcentajeCarga == 0 ? "Cargando..." : mensajeProgressBar}})</p>
        </div>
        <br/>
        <div>
            <div class="field-form-pp">
                <mat-form-field style="width: 100%;" appearance="outline">
                    <mat-label>Time zone</mat-label>
                    <mat-select [formControl]="pais" (selectionChange)="select(pais)">
                        <mat-option *ngFor="let zona of MListGMT" [value]="zona.diferencia">
                            {{zona.time}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>
        <div>
            <div>
                <label class="mi-etiqueta">
                    Archivo ARP: <br><!-- <mat-icon class="example-tab-icon">done-circule</mat-icon> <mat-icon>close</mat-icon><br> -->
                    <input [disabled]="activarBarra" type="file" placeholder="Carga archivos ARP:" accept=".xlsx, .xls" (change)="activarARP('ARP',$event)" #fileInput1>
                </label>
            </div>
        </div>
        <div>
            <div>
                <label class="mi-etiqueta">
                    Archivo TSE: <br>
                    <input [disabled]="activarBarra" type="file" placeholder="Carga archivos TSE:" accept=".xlsx, .xls" (change)="activarARP('TSE',$event)" #fileInput2>
                </label>
            </div>
        </div>
        <div>
            <div>
                <label class="mi-etiqueta">
                    Archivo STE: <br>
                    <input [disabled]="activarBarra" type="file" placeholder="Carga archivos STE:" accept=".xlsx, .xls" (change)="activarARP('STE',$event)" #fileInput3>
                </label>
            </div>
        </div>



<div style="text-align: center;">
    <button  mat-raised-button color="primary" [disabled]="activarBarra" *ngIf="botonARP && botonTSE && botonSTE && paisSeleccionado" (click)="readExcel(fileInput1, fileInput2, fileInput3)">Subir Archivos<mat-icon>cloud_upload</mat-icon></button>
</div>
        

    </div>
    <br/>
    
    <div style="text-align: justify;width: 90%;margin-left: 29px;">
        <p style="color: #eb5981;font-size: 1.2em;"><strong>PARA TENER EN CUENTA</strong></p>
        <p>Señor usuario, recuerde que para realizar su carga de archvios <b>ARP, TSE y STE</b>, debe modificar el nombre de los archivos de excel a <b>PORTAL_ARP, PORTAL_TSE, PORTAL_STE</b>, no olvide que la informacion dentro del excel no debe ser modificada para evitar errores, todos los datos que desee modificar debe hacerlo dentro de las plataformas alternas al portal.</p>
    </div>
    </mat-tab>

    <!-- <mat-tab>
        <ng-template mat-tab-label>
            <mat-icon class="example-tab-icon">upload_file</mat-icon>
            Subir Plantilla Horarios
        </ng-template>
        <br>
        <div class="body-excel">
            <mat-progress-bar mode="indeterminate" *ngIf="activarBarraHorarios"></mat-progress-bar>
            <div class="centrado">
            <label class="mi-etiqueta">
                Cargar plantilla Horarios 
                <br>
                <input type="file" [disabled]="activarBarraHorarios" (change)="activarARP('Horario',$event)" id="input-excel" placeholder="Carga de plantilla horarios" accept=".xlsx, .xls" #fileInput4>
            </label>
        </div>

        <button class="boton" *ngIf="botonHorario" (click)="readExcelHorario(fileInput4)">
            Subir Archivo
        </button>
        </div>
       
    </mat-tab> -->

    <mat-tab>
        <ng-template mat-tab-label>
            <mat-icon class="example-tab-icon">upload_file</mat-icon>
            Subir Plantilla Workday Gerentes
        </ng-template>
        <br>
        <div class="body-excel">
            <mat-progress-bar mode="indeterminate" *ngIf="activarBarraWorkday"></mat-progress-bar>
            <div>
                <div class="centrado">
                    <label class="mi-etiqueta">
                        Cargar plantilla Workday Horas 
                        <br>
                        <input type="file" [disabled]="activarBarraWorkday" (change)="activarARP('WorkdayHoras',$event)" id="input-excel" placeholder="Carga de plantilla horas" accept=".xlsx, .xls" #fileInputWorkdayHoras>
                    </label>
                </div>
            </div>
            <div>
                <div class="centrado">
                    <label class="mi-etiqueta">
                        Cargar plantilla Workday Users 
                        <br>
                        <input type="file" [disabled]="activarBarraWorkday" (change)="activarARP('WorkdayUsers',$event)" id="input-excel" placeholder="Carga de plantilla users" accept=".xlsx, .xls" #fileInputWorkdayUsers>
                    </label>
                </div>
            </div>

        <button class="boton" *ngIf="botonWorkdayHoras && botonWorkdayUsers" (click)="readExcelWorkdayG(fileInputWorkdayHoras, fileInputWorkdayUsers)">
            Subir Archivo
        </button>
        <a #downloadWorkdayFileEl style="display:none;"></a>
        </div>
       
    </mat-tab>



    <mat-tab>
        <ng-template mat-tab-label>
            <mat-icon class="example-tab-icon">upload_file</mat-icon>
            Subir Plantilla Zona Horaria Usuarios
        </ng-template>
        <br>

        <div class="body-excel" style="width: 95%;">
            <div class="overlay" *ngIf="activarBarra" style="padding:40%;position: fixed;padding-top: 20%;">
                <mat-spinner [diameter]="50"></mat-spinner>

            </div>
            <div style="width: 100%;">
            <mat-progress-bar mode="determinate" [value]="porcentajeCarga" *ngIf="activarBarra"></mat-progress-bar>
            <p *ngIf="activarBarra" class="texto-barra-carga">{{ porcentajeCarga }}% completado ({{ porcentajeCarga == 0 ? "Cargando..." : mensajeProgressBar}})</p>
            </div>
            <br/>
            <div>
                <div>
                    <label class="mi-etiqueta">
                        Archivo Usuarios Zona Horaria: <br>
                        <input [disabled]="activarBarra" type="file" placeholder="Carga archivos ARP:" accept=".xlsx, .xls" (change)="activarARP('UserGMT',$event)" #fileInputUserGMT>
                    </label>
                </div>
            </div>

    <div style="text-align: center;">
        <button  mat-raised-button color="primary" [disabled]="activarBarra" *ngIf="botonUsers" (click)="readExcelUsers(fileInputUserGMT)">Subir Archivos<mat-icon>cloud_upload</mat-icon></button>
    </div>
            

        </div>
        
    </mat-tab>
</mat-tab-group>

    </div>
